%table.table.table-striped.table-condensed#table-events
  %thead
    %tr.table-events-filters
      %th{:colspan => "3"}
        .input-prepend.pull-left
          %span.add-on
            %i.icon-search
          %input.span4#events-filter{:placeholder => "Поиск", :type => "text"}
        .input-append.pull-left
          %input#reportrange{:type => "text", :placeholder => 'За все время'}
            %span.add-on
              %i.icon-calendar
      %th{:colspan => "3"}
        %a.pull-right.btn.btn-margin{"data-toggle" => "modal", :href => "#newEventModal"} Создать мероприятие
        
    %tr
      %th.events-title.type-string Название
      %th.events-customer.type-string Заказчик
      %th.events-date.type-int Начало
      %th.events-date.type-int Конец
      %th.events-city.type-string Город
      %th
  - @events.includes([:company]).each do |event|
    %tr
      %td= event.name
      %td= event.company[:name]
      %td.events-start{"data-order-by" => event.date_start.to_time.to_i}
        = event.date_start.strftime("%d.%m.%y")
      %td.events-end{"data-order-by" => event.date_end.to_time.to_i}
        = event.date_end.strftime("%d.%m.%y")
      %td= event.city
      %td.event-actions
        .btn-group
          = link_to 'Войти', event, {:class => 'btn btn-small btn-success'}
          %button.btn.btn-small.btn-success.dropdown-toggle{"data-toggle" => "dropdown"}
            %span.caret
          %ul.dropdown-menu.dropdown-menu-narrow
            %li
              %a{:href => "#"} В архив
            %li
              = link_to 'Удалить', event, method: :delete, data: { confirm: 'Удалить мероприятие?' }

#newEventModal.modal.hide.fade{:role => "dialog", :tabindex => "-1"}
  = simple_form_for @new_event do |f|
    .modal-header
      %button.close{"data-dismiss" => "modal", :type => "button"} ×
      %h3 Новое мероприятие
    .modal-body
      = f.error_notification

      = f.input :name,       :label => 'Название', :required => false
      = f.association :company, :label => 'Заказчик', :required => false
      %label
        Дата проведения
      .input-prepend
        %span.add-on
          %i.icon-calendar
        %input{:type => "text", :name => "event-dates", :class => 'datepicker-range'}
      = f.input :city,       :label => 'Город', :required => false

    .modal-footer
      %button.btn{"data-dismiss" => "modal"} Закрыть
      = f.button :submit, 'Добавить', :class => 'btn btn-primary'
